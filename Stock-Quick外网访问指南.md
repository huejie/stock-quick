# 🌐 Stock-Quick 外网访问指南

## 📍 服务器信息
- **公网IP**: `42.193.179.88`
- **内网IP**: `10.1.0.14`
- **操作系统**: OpenCloudOS
- **服务状态**: 正常运行

## 🔗 访问地址

### 🎨 前端页面 (可直接访问)
```
http://42.193.179.88:7777
```

### ⚙️ 后端API (通过前端代理访问)
由于云服务器安全组限制，后端API端口(9000)可能无法直接从外网访问。
但可以通过前端代理访问所有API功能。

### 📊 API测试地址
以下API可以通过前端代理访问：

1. **市场热点数据**
   ```
   http://42.193.179.88:7777/api/market/hot
   ```

2. **自选股管理**
   ```
   http://42.193.179.88:7777/api/watchlist
   ```

3. **股票搜索**
   ```
   http://42.193.179.88:7777/api/watchlist/search?keyword=茅台
   ```

## 🚀 快速测试

### 1. 测试前端页面访问
```bash
# 使用curl测试
curl -s http://42.193.179.88:7777 | head -10

# 或在浏览器中直接访问
# http://42.193.179.88:7777
```

### 2. 测试API功能
```bash
# 测试市场热点API（通过前端代理）
curl -s "http://42.193.179.88:7777/api/market/hot"

# 测试自选股API
curl -s "http://42.193.179.88:7777/api/watchlist"
```

## 🔧 技术架构

### 当前部署架构
```
外网用户
    ↓
[42.193.179.88:7777] ← 前端服务 (uni-app + Vite)
    ↓ (代理转发)
[10.1.0.14:9000] ← 后端服务 (FastAPI)
```

### 前端代理配置
前端配置了代理，将所有 `/api/*` 请求转发到后端服务：
```javascript
// vite.config.ts
proxy: {
  '/api': {
    target: 'http://42.193.179.88:9000',
    changeOrigin: true,
  }
}
```

## 📋 端口状态

### 开放端口
- **7777端口**: ✅ 开放 (前端服务)
- **9000端口**: ⚠️ 可能被安全组阻止 (后端服务)

### 服务状态检查
```bash
# 检查前端服务
curl -I http://42.193.179.88:7777
# 预期返回: HTTP/1.1 200 OK

# 检查API功能
curl -s "http://42.193.179.88:7777/api/market/hot" | jq '.code'
# 预期返回: 0 (表示成功)
```

## 🎯 功能验证

### 已验证功能
1. ✅ **前端页面访问**: 可以正常加载
2. ✅ **市场热点数据**: 可以通过代理访问
3. ✅ **自选股管理**: 可以通过代理访问
4. ✅ **股票搜索**: 可以通过代理访问

### 待验证功能
1. ⚠️ **直接后端API访问**: 需要云服务商安全组配置
2. ⚠️ **WebSocket连接**: 如果需要实时数据

## 🔐 安全建议

### 当前安全措施
1. **端口限制**: 只开放必要端口
2. **代理转发**: 通过前端代理访问后端
3. **CORS配置**: 后端已配置跨域支持

### 建议增强措施
1. **HTTPS支持**: 添加SSL证书
2. **身份验证**: 添加用户登录系统
3. **API限流**: 防止滥用
4. **防火墙规则**: 细化端口访问控制

## 🛠️ 故障排除

### 常见问题

#### 1. 无法访问前端页面
```bash
# 检查端口是否开放
telnet 42.193.179.88 7777
# 或使用nc
nc -zv 42.193.179.88 7777
```

#### 2. API返回404错误
```bash
# 检查代理配置
curl -v "http://42.193.179.88:7777/api/health"
```

#### 3. 数据加载缓慢
- 检查网络连接
- 检查服务器资源使用情况
- 考虑添加CDN加速

### 服务重启
如果服务异常，可以重启：
```bash
cd /root/code/stock-quick
./start_all.sh
```

## 📞 技术支持

### 服务器状态监控
```bash
# 查看服务进程
ps aux | grep -E "(uvicorn|vite)"

# 查看服务日志
tail -f /root/code/stock-quick/backend/server.log
tail -f /root/code/stock-quick/frontend/frontend.log
```

### 性能监控
```bash
# 查看端口监听状态
netstat -tlnp | grep -E ":7777|:9000"

# 查看资源使用
top -b -n 1 | grep -E "(node|python)"
```

## 🚀 下一步优化

### 短期优化
1. [ ] 配置云服务商安全组，开放9000端口
2. [ ] 添加HTTPS支持
3. [ ] 配置域名访问

### 长期优化
1. [ ] 部署负载均衡
2. [ ] 添加监控告警
3. [ ] 实现自动扩缩容

---

**最后更新**: 2026-02-04 09:10  
**服务状态**: ✅ 正常运行  
**外网访问**: ✅ 前端页面可访问，API通过代理可访问  

**🐱 小K提示**: 现在可以通过 `http://42.193.179.88:7777` 访问Stock-Quick股票应用！